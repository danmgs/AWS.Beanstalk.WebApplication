# AWS.Beanstalk.WebApplication
A demo web application in .NET Core for AWS Elastic Beanstalk. It is leveraging AWS DynamoDB and X-Ray services.

## 1. Prerequisites

Elasticbeanstalk will create environment with EC2 instance(s) which require you setup following role :
- default elasticbeanstalk role generated by AWS extended with following:

    * SSM Role to log into EC2 via AWS Session manager console (for debug ..etc)
    * Custom inline policy **"MyCustomPolicy"** for DynamoDB, X-Ray, SNS operations defined as below:

```
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "CustomPolicy",
            "Effect": "Allow",
            "Action": [                
                "sns:Publish",                
                "dynamodb:PutItem",
                "dynamodb:DescribeTable",
                "dynamodb:DeleteItem",                
                "dynamodb:GetItem",
                "dynamodb:Scan",
                "dynamodb:UpdateItem",
                "xray:GetSamplingStatisticSummaries",
                "xray:PutTelemetryRecords",
                "xray:GetSamplingRules",
                "xray:GetSamplingTargets",
                "xray:PutTraceSegments"
            ],
            "Resource": "*"
        }
    ]
}
```

EC2 profile should look like :

![alt capture](https://github.com/danmgs/AWS.Beanstalk.WebApplication/blob/master/img/configure_ec2_profile.PNG)

## 2. Getting started


- Run the script **AWS.Beanstalk.WebApplication\scripts\pack.bat** to generate the application file **bundle.zip** in the **output** directory.
This bundle contains :<br>
    * the application binaries
    * .ebextensions configuration files
        * custom environment variables,
        * elasticbeanstalk setup, 
        * aws resources such as Dynamodb table, 
        * X-Ray daemon setup ... etc 
	* a manisfest file **aws-windows-deployment-manifest.json** describing the deployment in IIS

- Under ElasticBeanstalk console, create an application then its environment with selected platform **.NET (Windows/IIS)** and upload the **bundle.zip** file.

- Once the environment is created, browse the website
    * play with the product page. Product items will be stored and retrieved from generated **Product** dynamoDB table.
    * check the X-Ray console for insights.


